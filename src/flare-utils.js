// Copyright 2024 Andrew Caya <andrewscaya@yahoo.ca>
// Copyright 2024 Jean-Thomas Caya

export const FlareAbis = {
    DistributionToDelegators: distributionAbi,
    VoterWhitelister: voterWhitelisterAbi,
    FtsoRewardManager: ftsoRewardAbi,
    RewardManager: rewardManagerAbi,
    WNat: wnatAbi,
    FlareRegistry: flareAbi,
    AddressBinder: addressBinderAbi,
    ValidatorRewardManager: validatorRewardAbi,
    FlareSystemsManager: systemsManagerAbi,
    FAssetToken: fassetTokenAbi,
};

export var selectedNetwork = document.getElementById("SelectedNetwork");

export const FlareLogos = {
    sgbLogo: '<g id="layer1-3"><polygon points="124.29 316.35 0 538.51 101.68 508.22 124.29 316.35"></polygon><polygon points="259.45 315.45 135.35 299.46 119.98 431.6 300.07 320.69 259.45 315.45"></polygon><polygon points="195.58 206.32 233.21 158.92 40.08 0 133.09 285.06 195.58 206.32"></polygon><polygon points="363.82 188.11 343.46 245.8 383.66 282.19 363.82 188.11"></polygon><polygon points="263.6 221.16 263.6 221.16 238.46 166.78 215.95 195.14 139.88 290.97 265.69 307.18 305.76 312.35 263.6 221.16"></polygon><polygon points="357 180.39 273.62 221.37 312.7 305.92 357 180.39"></polygon></g>',
    flrLogo: '<g id="layer1-2" transform="matrix(1.7,0,0,1.7,-0,120)"><path inkscape:connector-curvature="0" d="M 1.54,44.88 C 1.54,44.88 0,44.043066 0,43.309998 0,29.293727 13.305791,-2.1604174e-7 44.83,-2.1604171e-7 c 7.083657,1e-14 178,0 178,0 0,0 1.54998,0.83699994604171 1.54,1.57000021604171 -0.28292,20.783154 -17.20265,43.31 -44.86,43.31 -7.19693,0 -177.97,0 -177.97,0 z" id="path5842" /><path inkscape:connector-curvature="0" d="M -2.8370967e-7,133.36 C -0.01006008,134.093 1.5399997,134.93 1.5399997,134.93 c 0,0 73.8666673,0 110.8000003,0 25.5862,0 44.57708,-22.52684 44.86,-43.309998 0.01,-0.733001 -1.54,-1.570002 -1.54,-1.570002 0,0 -96.641983,0 -110.78,0 -25.4532,0 -44.5947035,22.52208 -44.88000028370967,43.31 z" id="path5840" /><path d="M 45.068739,202.56174 A 22.648399,22.301296 0 0 1 22.42034,224.86303 22.648399,22.301296 0 0 1 -0.22805977,202.56174 22.648399,22.301296 0 0 1 22.42034,180.26044 a 22.648399,22.301296 0 0 1 22.648399,22.3013 z" id="path5799" /></g>',
    costonLogo: '<g id="layer1-2"><path id="path5139" d="M 110.76382,510.98934 C 70.863727,504.70145 37.406693,477.5049 25.686374,441.83158 21.84306,430.13361 19.836232,415.02432 21.826707,412.77241 c 1.424546,-1.61163 13.378995,-1.76178 115.549773,-1.45126 113.89386,0.34613 113.96658,0.34786 123.75346,2.93072 36.37734,9.60039 64.41727,34.6805 75.08928,67.16306 3.80582,11.58382 5.84887,26.80869 3.89427,29.02001 -1.37588,1.55658 -14.29072,1.74294 -112.48957,1.62329 -61.01439,-0.0744 -113.60143,-0.55536 -116.8601,-1.06889 z M 58.12374,360.57705 c -25.044789,-7.74036 -40.80884,-31.76562 -36.505138,-55.6358 5.200706,-28.84542 33.769366,-47.59015 63.581441,-41.71767 20.233567,3.98566 34.715427,16.60405 40.884757,35.62379 7.82371,24.12021 -6.46935,51.40502 -31.733007,60.57687 -9.9696,3.61941 -26.540903,4.14674 -36.228053,1.15281 z M 21.826707,211.65048 c -1.990475,-2.2519 0.0164,-17.36119 3.859667,-29.05914 10.672006,-32.48258 38.711933,-57.56269 75.089266,-67.16307 9.78689,-2.58285 9.8596,-2.58458 123.75348,-2.93073 102.17076,-0.31051 114.12522,-0.16035 115.54977,1.45129 1.99047,2.25188 -0.0165,17.36119 -3.85967,29.05914 -10.67201,32.48257 -38.71194,57.56268 -75.08928,67.16306 -9.78688,2.58287 -9.8596,2.58459 -123.75346,2.93073 -102.170778,0.3105 -114.125227,0.16037 -115.549773,-1.45128 z"/></g>',
}

export const MMSDK = new MetaMaskSDK.MetaMaskSDK({
    dappMetadata: {
        name: "FTSO Canada DApp",
        url: "https://ftsocan.com",
        base64Icon: "iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAYAAAA9zQYyAAApPXpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjarZxpkh63ckX/YxVeAhIzloMxwjvw8n0uqkVJfPKLsMNkSGx2fzUhM++QyKI7",
    },
    logging: {
        sdk: false,
    },
    checkInstallationImmediately: false,
    extensionOnly: true,
    preferDesktop: true
});

// Getting the key of a function by its name.
function getKeyByValue(object, value) {
    return Object.keys(object).find(key => object[key] === value);
}

export async function GetContract(ContractName, rpcurl, flrAddr) {
    let networkName = GetNetworkName(rpcurl);

    if (contractOverrideConfig[networkName][ContractName] !== "") {
        return contractOverrideConfig[networkName][ContractName];
    }

    let web3 = new Web3(rpcurl);
    let flareContract = new web3.eth.Contract(FlareAbis.FlareRegistry, flrAddr);
    const SmartContracts = await flareContract.methods.getAllContracts().call();
    const wrappedTokenIndex = getKeyByValue(Object.values(SmartContracts)[0], ContractName);
    const wrappedTokenAddr = SmartContracts[1][wrappedTokenIndex];

    return wrappedTokenAddr;
}

export function GetNetworkName(rpcUrl) {
    if (rpcUrl.includes("flr")) {
        return "flare";
    } else if (rpcUrl.includes("sgb")) {
        return "songbird";
    }
}

export function round(num, exp = 4) {
    return +(Math.round(num + "e+" + String(exp)) + "e-" + String(exp));
}

export async function updateCurrentBalancesStatus(balance, tokenBalance, pBalance) {
    try {   
        if (typeof balance !== 'undefined') {
            document.getElementById('balanceInfo').innerText = String(round(balance));
    
            cachedValues.balance = String(round(balance));
    
            if (round(balance) > 0) {
                document.getElementById('balanceInfoText').style.color = "#fd000f";
                document.getElementById('balanceInfo').style.color = "#fd000f";
            } else {
                document.getElementById('balanceInfoText').style.color = "#aaaaaa";
                document.getElementById('balanceInfo').style.color = "#aaaaaa";
            }
        }
    
        if (typeof tokenBalance !== 'undefined') {
            document.getElementById('wnatInfo').innerText = String(round(tokenBalance));
    
            cachedValues.tokenBalance = String(round(tokenBalance));
    
            if (round(tokenBalance) > 0) {
                document.getElementById('wnatInfoText').style.color = "#383a3b";
                document.getElementById('wnatInfo').style.color = "#383a3b";
            } else {
                document.getElementById('wnatInfoText').style.color = "#aaaaaa";
                document.getElementById('wnatInfo').style.color = "#aaaaaa";
            }
        }
    
        if (typeof pBalance !== 'undefined') {
            document.getElementById('pBalanceInfo').innerText = String(round(pBalance));
    
            cachedValues.pBalance = String(round(pBalance));
    
            if (round(pBalance) > 0) {
                document.getElementById('pBalanceInfoText').style.color = "#383a3b";
                document.getElementById('pBalanceInfoText').classList.add("dark-link");
    
                const iconElement = document.getElementById('pBalanceArrow');
    
                iconElement.style.display = 'inline-block';
                iconElement.setAttribute('colors', 'primary:#383a3b');
                iconElement.setAttribute('state', 'in-reveal');
                iconElement.setAttribute('trigger', 'in');
    
                iconElement.playerInstance.addEventListener('complete', (e) => {
                    // change to assigned state
                    iconElement.setAttribute('state', 'hover-slide');
                    iconElement.setAttribute('target', '#pBalanceLink');
                
                    // play from beginning
                    iconElement.setAttribute('trigger', 'hover');
                }, { once: true });
    
                document.getElementById('pBalanceInfo').style.color = "#383a3b";
            } else {
                document.getElementById('pBalanceInfoText').style.color = "#aaaaaa";
                document.getElementById('pBalanceInfoText').classList.remove("dark-link");
    
                const iconElement = document.getElementById('pBalanceArrow');
    
                iconElement.style.display = 'none';
                iconElement.setAttribute('colors', 'primary:#aaaaaa');
                iconElement.removeAttribute('trigger');
    
                document.getElementById('pBalanceInfo').style.color = "#aaaaaa";
            }
        }
    
        document.querySelectorAll(".odometer-radix-mark").forEach(element => {
            if (dappLanguage === "fr_FR") {
                element.innerText = ",";
            } else {
                element.innerText = ".";
            }
        });
    } catch (error) {
        console.log(error);
    }
}

export async function openAddressInExplorer(address, networkIndex) {
    let urlPrefix = "flare";

    if (networkIndex == 1) {
        urlPrefix = "flare";
    } else if (networkIndex == 2) {
        urlPrefix = "songbird";
    }

    window.open("https://" + urlPrefix + "-explorer.flare.network/address/" + address, '_blank').focus();
}

export async function openAddressInPExplorer(address) {
    window.open(explorerConfig.pChainUrl + "address/" + address, '_blank').focus();
}

export function updateCurrentAccountStatus(address, networkIndex, isAccountConnected, walletIndex, pAddress) {
    let clickBind = () => {openAddressInExplorer(address, DappObject.selectedNetworkIndex);};

    let pClickBind = () => {openAddressInPExplorer(pAddress.slice(2));};

    let currentAccount = document.getElementById('currentAccount');
    let currentPAccount = document.getElementById('currentPAccount');
    let currentNetworkLogo = document.getElementById('currentNetworkLogo');

    if (address.startsWith('0x') && address.length > 3) {
        currentAccount.innerText = address.slice(0, 6) + "..." + address.slice(-4);

        if (currentAccount.innerText.toLowerCase() !== "0x0000...0000") {
            currentAccount.style.color = "#383a3b";

            document.getElementById('viewCurrentInExplorer').classList.remove("disabled");
            document.getElementById('viewCurrentInExplorer').addEventListener('click', clickBind);
        } else {
            currentAccount.style.color = "#aaaaaa";

            document.getElementById('viewCurrentInExplorer').classList.add("disabled");

            const oldElement = document.getElementById('viewCurrentInExplorer');
            const newElement = oldElement.cloneNode(true);
            oldElement.replaceWith(newElement);
        }
    }

    if (typeof pAddress !== 'undefined') {
        currentPAccount.innerText = pAddress.slice(0, 10) + "..." + pAddress.slice(-4);

        if (currentPAccount.innerText.toLowerCase() !== "p-00000000...0000") {
            currentPAccount.style.color = "#383a3b";

            document.getElementById("pBalanceLink").addEventListener('click', pClickBind);
        } else {
            currentPAccount.style.color = "#aaaaaa";

            const oldElement = document.getElementById("pBalanceLink");
            const newElement = oldElement.cloneNode(true);
            oldElement.replaceWith(newElement);
        }
    }

    if (networkIndex) {
        if (networkIndex == 1) {
            currentNetworkLogo.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 383.66 538.51" fill="currentColor" style="width: 35px; height: 45px;">' + FlareLogos.flrLogo + "</svg>";
        } else if (networkIndex == 2) {
            currentNetworkLogo.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 383.66 538.51" fill="currentColor" style="width: 35px; height: 45px;">' + FlareLogos.sgbLogo + "</svg>";
        }
    }

    if (typeof isAccountConnected !== 'undefined') {
        if (isAccountConnected === true) {
            currentNetworkLogo.style.color = "#fd000f";
        } else if (isAccountConnected === false) {
            currentNetworkLogo.style.color = "#aaaaaa";
        }
    }

    if (typeof walletIndex !== 'undefined') {
        document.getElementById('currentWalletLogoBg').style.backgroundColor = "#f44234";
        if (walletIndex == -1) {
            document.getElementById('currentWalletLogoBg').style.backgroundColor = "#fff";
            document.getElementById('currentWalletLogo').innerHTML = '<svg width="115" height="78" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 25 25" stroke-width="1.1" stroke="#fd000f"><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 0V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v3" /></svg>';
        } else if (walletIndex == 0) {
            document.getElementById('currentWalletLogo').innerHTML = DappObject.browserWalletLogo;
        } else if (walletIndex == 1) {
            document.getElementById('currentWalletLogo').innerHTML = '<svg width="147" height="128" viewBox="0 0 204 192" style="width: 100%; height: 100%;" fill="none" version="1.1" id="svg1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs1" /> <path d="M 28.5,123.6548 V 160 h 55.293 v -8.06 H 36.55631 v -28.2852 z m 138.944,0 V 151.94 h -47.237 v 8.058 H 175.5 V 123.6548 Z M 83.8733,68.3452 v 55.3077 h 36.3337 v -7.2687 H 91.9296 V 68.3452 Z M 28.5,32 v 36.3452 h 8.05631 V 40.05844 H 83.793 V 32 Z m 91.707,0 v 8.05844 h 47.237 V 68.3452 H 175.5 V 32 Z" fill="#000000" id="path1" style="fill:#ffffff;fill-opacity:1" /></svg>';
        } else if (walletIndex == 2) {
            document.getElementById('currentWalletLogo').innerHTML = '<svg width="155" height="118" viewBox="0 0 204 192" style="width: 100%; height: 100%; fill: none;" version="1.1" id="svg1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><defs id="defs8" /> <path d="m 55.626723,67.925292 c 25.686212,-25.149002 67.331667,-25.149002 93.018287,0 l 3.0911,3.026628 c 1.28427,1.257607 1.28427,3.296196 0,4.553804 L 141.1613,85.859455 c -0.64234,0.628804 -1.68338,0.628804 -2.32571,0 l -4.25397,-4.164954 c -17.91948,-17.54474 -46.972437,-17.54474 -64.891919,0 l -4.555855,4.460283 c -0.641929,0.628804 -1.682964,0.628804 -2.325303,0 L 52.233724,75.801053 c -1.284679,-1.257609 -1.284679,-3.296197 0,-4.553805 z m 114.888197,21.412889 9.41195,9.21467 c 1.28428,1.257603 1.28428,3.296189 0,4.553789 l -42.43831,41.55153 c -1.28428,1.2572 -3.36675,1.2572 -4.65103,0 L 102.7173,115.16796 c -0.32117,-0.31461 -0.84169,-0.31461 -1.16286,0 l -30.119429,29.49021 c -1.284265,1.2572 -3.366746,1.2572 -4.651016,0 l -42.43943,-41.55193 c -1.28431,-1.25761 -1.28431,-3.296196 0,-4.553801 l 9.411797,-9.215078 c 1.284311,-1.257198 3.366623,-1.257198 4.650935,0 l 30.120778,29.490619 c 0.32076,0.31461 0.841275,0.31461 1.162449,0 L 99.809538,89.337361 c 1.284272,-1.257198 3.366752,-1.257198 4.651012,0 l 30.12066,29.490619 c 0.32117,0.31461 0.84169,0.31461 1.16285,0 L 165.8639,89.338181 c 1.28469,-1.257608 3.36675,-1.257608 4.65102,0 z" id="path2" style="fill:#ffffff;fill-opacity:1;stroke-width:1" /></svg>';
        } else if (walletIndex == 3) {
            document.getElementById('currentWalletLogo').innerHTML = '<svg width="80" fill="none" version="1.1" viewBox="0 0 204 192" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><path d="m99.098 177.19c-1.3368-0.77333-2.7821-1.6029-3.2118-1.8435-0.42968-0.2406-1.5234-0.86654-2.4305-1.391-0.90711-0.52443-2.079-1.1892-2.6042-1.4774-0.52517-0.28811-1.1622-0.66816-1.4157-0.84456-0.25345-0.1764-0.50877-0.32073-0.56737-0.32073-0.0586 0-0.62093-0.3125-1.2496-0.69444s-1.1816-0.69444-1.2287-0.69444c-0.04712 0-0.29304-0.14433-0.54649-0.32073-0.25345-0.1764-0.89051-0.55552-1.4157-0.84248-0.52517-0.28695-1.2478-0.6895-1.6059-0.89454s-0.944-0.53737-1.3021-0.73851c-0.35807-0.20115-0.72916-0.42427-0.82465-0.49583-0.09549-0.0716-0.6033-0.36355-1.1285-0.64885s-2.2048-1.245-3.7326-2.1327-3.2074-1.8493-3.7326-2.1369c-0.52517-0.28762-1.1622-0.66727-1.4157-0.84367-0.25346-0.17639-0.50392-0.32073-0.5566-0.32073-0.05264 0-0.50936-0.24528-1.0149-0.54508-0.5055-0.2998-1.173-0.69042-1.4833-0.86805-0.31033-0.17764-0.8572-0.49073-1.2153-0.69576-0.35807-0.20504-1.0807-0.60691-1.6059-0.89306-0.52517-0.28613-1.033-0.5788-1.1285-0.65036-0.09549-0.0716-0.46658-0.29468-0.82465-0.49583-0.35807-0.20114-0.92447-0.52197-1.2587-0.71294-0.3342-0.19098-0.88107-0.50348-1.2153-0.69444-0.3342-0.19098-0.88107-0.50347-1.2153-0.69444-0.3342-0.19098-0.88107-0.50347-1.2153-0.69444-1.6429-0.9388-1.9659-1.1222-2.691-1.5278-0.42969-0.24039-1.0727-0.61997-1.4288-0.8435-0.35617-0.22355-0.69568-0.40645-0.75444-0.40645-0.05879 0-0.31423-0.14432-0.56768-0.32072-0.25346-0.17641-0.89051-0.55733-1.4157-0.8465-0.70287-0.38703-12.628-7.2175-16.58-9.4961-0.19097-0.11012-0.81597-0.47063-1.3889-0.8011-0.5729-0.33047-1.276-0.72745-1.5625-0.88218l-0.52083-0.28132v-81.688l0.52083-0.28487c0.28646-0.15669 1.0133-0.57611 1.6152-0.93207 0.60192-0.35595 1.1367-0.64719 1.1885-0.64719 0.05179 0 0.30148-0.14432 0.55493-0.32072 0.25345-0.1764 0.89052-0.55552 1.4157-0.84247 0.52517-0.28697 1.2478-0.68951 1.6059-0.89455 0.35807-0.20503 0.92447-0.52904 1.2587-0.72001 0.33421-0.19098 0.88107-0.50348 1.2153-0.69444 1.5041-0.85948 1.7897-1.025 2.6552-1.5382 0.50549-0.2998 0.96017-0.54508 1.0104-0.54508 0.05024 0 0.43194-0.23438 0.84829-0.52083 0.41635-0.28646 0.79426-0.52083 0.83981-0.52083 0.0455 0 1.0471-0.55711 2.2256-1.238 1.1786-0.68092 2.5725-1.4757 3.0977-1.7661 0.52517-0.29044 1.7238-0.98332 2.6637-1.5397s1.7372-1.0117 1.7719-1.0117c0.03468 0 0.47661-0.24529 0.98211-0.54508 0.5055-0.2998 1.1535-0.68132 1.4399-0.84783 1.0357-0.60204 20.679-11.853 21.441-12.281 0.42968-0.24114 1.5234-0.86753 2.4305-1.392 0.90711-0.52444 2.079-1.1892 2.6042-1.4774 0.52517-0.28811 1.1502-0.65626 1.3889-0.81807 0.23871-0.16184 0.86371-0.52902 1.3889-0.81599 0.92426-0.50503 1.6427-0.91111 2.8212-1.5946 7.5415-4.3737 11.85-6.7463 12.087-6.656 0.15549 0.05922 2.3921 1.3097 4.9702 2.7789 2.5781 1.4692 5.3515 3.047 6.1632 3.5064 2.8599 1.6186 23.893 13.598 25.607 14.585 0.95486 0.54954 6.8533 3.9097 13.108 7.4671 6.2543 3.5573 12.184 6.935 13.178 7.5059 0.99333 0.57088 2.1652 1.2362 2.6042 1.4785 0.43894 0.24232 1.5403 0.86903 2.4474 1.3927 0.90712 0.52367 1.9618 1.1299 2.3437 1.3471l0.69444 0.39496v81.664l-0.86805 0.50145c-0.47742 0.27581-1.7929 1.0165-2.9233 1.646-1.1304 0.62948-2.4585 1.3848-2.9514 1.6786-0.49288 0.29372-1.2868 0.74555-1.7642 1.0041s-1.8323 1.0277-3.0109 1.7094c-1.1786 0.68163-2.1667 1.2393-2.1958 1.2393-0.0291 0-0.56733 0.3125-1.196 0.69445-0.62869 0.38194-1.191 0.69444-1.2496 0.69444s-0.31392 0.14432-0.56738 0.32072c-0.25345 0.1764-0.89051 0.55869-1.4157 0.84955-0.9858 0.54594-4.1044 2.3091-5.2517 2.9691-1.5518 0.89268-2.0066 1.1492-2.908 1.6404-0.52517 0.28615-1.033 0.57882-1.1285 0.65038-0.0954 0.0716-0.46657 0.29468-0.82464 0.49582-0.35807 0.20116-0.94401 0.53349-1.3021 0.73852-0.35806 0.20503-1.0807 0.60691-1.6059 0.89306-0.52517 0.28613-1.033 0.5788-1.1285 0.65036-0.0955 0.0716-0.46658 0.29468-0.82465 0.49583-0.35807 0.20114-0.944 0.5303-1.3021 0.73143-0.35808 0.20116-0.72917 0.42459-0.82465 0.49653-0.0954 0.0719-0.79861 0.46751-1.5625 0.87906-1.6772 0.90358-2.1562 1.1725-3.3496 1.8803-0.5055 0.29979-0.94673 0.54508-0.98051 0.54508-0.0337 0-0.55769 0.29955-1.1642 0.66566-0.60655 0.36612-1.5325 0.90148-2.0577 1.1897-0.52518 0.28822-1.2478 0.6918-1.6059 0.89683-0.35806 0.20504-0.92447 0.52905-1.2587 0.72002s-0.88107 0.50347-1.2153 0.69444c-1.6429 0.93879-1.9659 1.1222-2.691 1.5278-0.42968 0.24039-1.0547 0.60221-1.3889 0.80404s-0.84201 0.48238-1.1285 0.62345c-0.28645 0.14107-1.132 0.62757-1.879 1.0811-0.74702 0.45356-1.3843 0.82465-1.4162 0.82465-0.0319 0-1.0222 0.55657-2.2008 1.2368-1.1786 0.68024-2.4163 1.3944-2.7505 1.587-0.3342 0.19264-0.93967 0.5345-1.3455 0.75972-0.40582 0.2252-1.0699 0.5938-1.4757 0.81907-0.40582 0.22529-1.1514 0.65497-1.6569 0.95486-0.5055 0.29989-0.99378 0.54525-1.0851 0.54525-0.0913 0-0.16597 0.059-0.16597 0.13123 0 0.0722-0.24467 0.23953-0.54371 0.3719s-1.0398 0.54207-1.6462 0.91043c-0.60635 0.36837-1.2796 0.66787-1.4962 0.66556-0.21657-2e-3 -1.4875-0.63695-2.8243-1.4103zm3.7326-6.0508c0.48582-0.28645 0.92441-0.52083 0.97461-0.52083s0.41787-0.21722 0.81701-0.48274c0.39914-0.2655 0.95806-0.59753 1.242-0.73783 0.28397-0.14032 1.4021-0.78246 2.4847-1.427 1.0826-0.64452 1.9954-1.1719 2.0283-1.1719 0.0329 0 1.0242-0.55664 2.2027-1.237 1.1786-0.68033 2.4944-1.4337 2.9241-1.6741 0.42968-0.24042 1.5234-0.86574 2.4305-1.3896 0.90712-0.52386 1.9618-1.1298 2.3437-1.3466 0.81445-0.46218 3.9118-2.2316 4.7412-2.7085 0.31601-0.1817 1.1363-0.6513 1.8229-1.0436 0.68659-0.39225 1.5022-0.85972 1.8126-1.0388 0.31032-0.17911 0.83766-0.48189 1.1719-0.67286 0.33419-0.19098 0.90059-0.51498 1.2587-0.72001 0.35807-0.20504 1.0807-0.60691 1.6059-0.89305 0.52517-0.28615 1.033-0.57897 1.1285-0.65072 0.0954-0.0717 0.56424-0.34241 1.0417-0.60148 0.47743-0.25905 1.1415-0.64543 1.4757-0.85861 0.3342-0.21316 1.3498-0.80271 2.2569-1.3101 0.90712-0.50736 2.079-1.176 2.6042-1.4858 0.99687-0.58807 10.1-5.7822 11.458-6.5381 0.42969-0.23908 1.0547-0.59386 1.3889-0.78839 1.7953-1.045 9.773-5.5981 9.8086-5.5981 0.023 0 0.73561-0.41589 1.5836-0.92421l1.5418-0.92419v-74.446l-1.9965-1.1717c-1.0981-0.64443-2.1918-1.278-2.4305-1.4079-0.97432-0.53023-4.9882-2.8196-8.4635-4.8274-0.31032-0.17928-0.83766-0.48223-1.1719-0.67319-0.3342-0.19098-0.88107-0.50348-1.2153-0.69444-0.3342-0.19098-0.88108-0.50347-1.2153-0.69444-0.33421-0.19098-0.90061-0.51664-1.2587-0.72373-0.35807-0.20707-1.1588-0.66264-1.7795-1.0124-0.62065-0.34972-1.4214-0.8053-1.7795-1.0124-0.61567-0.35605-0.97039-0.55935-2.5174-1.4427-0.35807-0.20448-1.0026-0.56625-1.4323-0.80396-0.4297-0.2377-1.506-0.85547-2.3919-1.3728-0.88587-0.51735-2.0577-1.1831-2.6042-1.4795-0.54642-0.29636-1.2009-0.68316-1.4543-0.85957-0.25345-0.17639-0.51483-0.32072-0.58084-0.32072-0.066 0-0.32738-0.14433-0.58083-0.32073-0.25345-0.17639-0.89051-0.55552-1.4157-0.84248-0.52517-0.28695-1.2674-0.70055-1.6493-0.91908-0.38194-0.21855-1.046-0.59402-1.4757-0.83441-0.42969-0.24039-1.0727-0.61996-1.4288-0.8435-0.35617-0.22354-0.68476-0.40644-0.7302-0.40644-0.0454 0-0.49621-0.24529-1.0017-0.54509-0.5055-0.29979-1.173-0.69042-1.4833-0.86805-1.377-0.78821-1.916-1.0943-2.6476-1.5036-0.42968-0.24039-1.0727-0.61996-1.4288-0.8435-0.35617-0.22353-0.68444-0.40644-0.72946-0.40644-0.045 0-1.0409-0.55818-2.213-1.2404-1.1722-0.68222-2.3869-1.3854-2.6993-1.5625-0.93186-0.52826-1.638-0.93492-2.7383-1.5769-0.57292-0.3343-1.3932-0.80266-1.8229-1.0408-1.572-0.87133-2.1739-1.2164-2.3437-1.3437-0.0955-0.0716-0.60329-0.36422-1.1285-0.65037-0.52517-0.28614-1.2674-0.70182-1.6493-0.92371-2.9844-1.7339-3.6313-2.0517-3.8914-1.9118-0.15136 0.0814-1.2395 0.70225-2.418 1.3797-1.1786 0.67743-2.1667 1.2317-2.1958 1.2317-0.02911 0-0.56732 0.31249-1.196 0.69444-0.62869 0.38193-1.191 0.69443-1.2496 0.69443-0.0586 0-0.31391 0.14433-0.56737 0.32073-0.25345 0.1764-0.89051 0.55842-1.4157 0.84893-0.52517 0.29051-1.9193 1.0837-3.0981 1.7626-1.1788 0.67891-2.1734 1.2344-2.2102 1.2344-0.03679 0-0.4983 0.27596-1.0256 0.61326-0.52727 0.33729-1.0952 0.66425-1.262 0.72658-0.16685 0.06232-0.79303 0.41136-1.3915 0.77563-0.59847 0.36427-1.1244 0.6623-1.1688 0.6623-0.04438 0-0.59125 0.3125-1.2153 0.69444-0.62402 0.38194-1.1737 0.69444-1.2215 0.69444-0.04779 0-0.60127 0.3125-1.23 0.69444s-1.1816 0.69444-1.2287 0.69444c-0.04712 0-0.29304 0.14433-0.54649 0.32073-0.25345 0.17639-0.89051 0.55551-1.4157 0.84247-0.52517 0.28696-1.2674 0.70101-1.6493 0.92012-0.38194 0.2191-1.1241 0.63418-1.6493 0.92241-0.52517 0.28822-1.4511 0.82358-2.0577 1.1897-0.60654 0.36611-1.1277 0.66566-1.1582 0.66566-0.03042 0-0.74512 0.40065-1.5882 0.89033-2.1047 1.2225-2.632 1.5249-3.4859 1.9988-1.7563 0.9747-2.2977 1.2815-3.7463 2.1231-0.84303 0.48978-1.6047 0.89051-1.6927 0.89051-0.08796 0-0.15992 0.05901-0.15992 0.13124 0 0.07222-0.24467 0.23952-0.54371 0.37189-0.29904 0.13237-1.0398 0.54206-1.6462 0.91043-0.60635 0.36838-1.1504 0.66976-1.209 0.66976-0.05861 0-0.32728 0.15718-0.59708 0.34929-0.26979 0.19212-0.90684 0.57066-1.4157 0.84121-1.1925 0.63406-2.2675 1.2421-2.4876 1.4072-0.09549 0.0716-0.60329 0.36422-1.1285 0.65037-0.52517 0.28615-1.2478 0.68801-1.6059 0.89305-1.3893 0.79556-1.8895 1.0802-2.5173 1.433-0.35807 0.20116-0.72917 0.42427-0.82465 0.49584-0.09543 0.0716-0.60329 0.36423-1.1285 0.65036-1.0116 0.55116-1.2803 0.70442-3.7029 2.1116-0.84304 0.48968-1.5882 0.89033-1.6559 0.89033-0.06768 0-0.37665 0.21485-0.68657 0.47743l-0.5635 0.47743 0.0072 37.062c0.0062 35.013 0.02373 37.078 0.30965 37.344 0.16645 0.1551 2.6854 1.6297 5.5977 3.2769 2.9123 1.6472 5.7248 3.2514 6.25 3.5649 0.52517 0.31353 1.5798 0.91897 2.3437 1.3454 0.76388 0.42646 2.6272 1.4899 4.1407 2.3632 1.5135 0.87333 2.7905 1.5879 2.8378 1.5879 0.04726 0 0.29335 0.14502 0.54681 0.32229 0.25346 0.17726 1.4374 0.86835 2.631 1.5358 2.268 1.2682 2.7157 1.5232 4.4271 2.5218 0.57291 0.33429 1.3932 0.8041 1.8229 1.044 1.6213 0.90523 4.6529 2.6401 6.0354 3.4539 0.78908 0.46448 1.4801 0.8445 1.5357 0.8445s0.30837 0.14432 0.56182 0.32073c0.25346 0.1764 0.89051 0.55552 1.4157 0.84247 0.52517 0.28697 1.2674 0.70056 1.6493 0.9191 0.38194 0.21852 1.046 0.59305 1.4757 0.83226 0.42969 0.23922 1.7969 1.0192 3.0382 1.7334 1.2413 0.71413 2.6085 1.4958 3.0382 1.737 0.42968 0.24124 2.8906 1.6476 5.4687 3.1251 2.5781 1.4776 5.1172 2.9223 5.6423 3.2104 0.52517 0.28814 1.033 0.58244 1.1285 0.65399 0.16274 0.12196 0.52383 0.32997 2.1267 1.2251 0.35807 0.19997 0.72526 0.43434 0.81596 0.52084 0.2447 0.23329 0.34619 0.20514 1.3108-0.36359zm-28.262-24.755c-0.30658-0.53376-0.55741-1.0416-0.55741-1.1285s-0.05872-0.15798-0.1305-0.15798c-0.07178 0-0.32201-0.3711-0.55606-0.82466-0.23405-0.45355-0.62693-1.1371-0.87306-1.5191-0.24613-0.38196-0.56218-0.92882-0.70234-1.2153-0.14015-0.28645-0.29402-0.55989-0.34191-0.60763-0.10926-0.10892-0.47492-0.74903-0.94205-1.6491-0.19816-0.38184-0.49702-0.84578-0.66412-1.031-0.1671-0.1852-0.30382-0.43918-0.30382-0.5644 0-0.12523-0.07812-0.22768-0.17361-0.22768-0.09549 0-0.17361-0.15626-0.17361-0.34723s-0.05872-0.34721-0.13051-0.34721c-0.07178 0-0.32377-0.3711-0.55998-0.82466-0.23621-0.45355-0.47628-0.8637-0.53348-0.91144-0.05719-0.0478-0.29348-0.43838-0.52508-0.86806-0.23159-0.42968-0.51862-0.88437-0.63783-1.0104-0.11921-0.12604-0.2644-0.419-0.32264-0.65105-0.05825-0.23203-0.17554-0.42188-0.26067-0.42188-0.08514 0-0.15479-0.0836-0.15479-0.18573 0-0.10214-0.22165-0.51231-0.49255-0.91146-0.2709-0.39914-0.60248-0.97962-0.73682-1.29-0.13435-0.31032-0.28874-0.56423-0.34309-0.56423-0.05435 0-0.20612-0.27344-0.33724-0.60764-0.13113-0.3342-0.30196-0.60763-0.37962-0.60763-0.07767 0-0.14121-0.0836-0.14121-0.18573 0-0.10214-0.22165-0.51231-0.49255-0.91146s-0.60247-0.97963-0.73682-1.29c-0.13435-0.31033-0.30332-0.56423-0.3755-0.56423-0.07218 0-0.13123-0.11719-0.13123-0.26042 0-0.14322-0.07813-0.26042-0.17361-0.26042-0.09549 0-0.17361-0.15624-0.17361-0.34721s-0.07812-0.34723-0.17361-0.34723c-0.09549 0-0.17361-0.12045-0.17361-0.26767s-0.14375-0.42198-0.31945-0.61057c-0.1757-0.18859-0.42722-0.55642-0.55893-0.81739-0.13171-0.26097-0.4567-0.80107-0.72221-1.2002-0.2655-0.39915-0.48273-0.79368-0.48273-0.87674 0-0.0831-0.09506-0.24607-0.21124-0.36224-0.22795-0.22796-1.1699-1.8242-1.6579-2.8096-0.16552-0.3342-0.35954-0.63368-0.43116-0.66552-0.07161-0.0319-0.13021-0.13492-0.13021-0.22913 0-0.0942-0.23438-0.51191-0.52083-0.92826-0.28646-0.41635-0.52084-0.80698-0.52084-0.86805 0-0.0611-0.23438-0.45171-0.52083-0.86805-0.28646-0.41635-0.52083-0.7912-0.52083-0.83301 0-0.0418-0.54688-0.98413-1.2153-2.094s-1.2153-2.0968-1.2153-2.193c0-0.0963-0.05873-0.17501-0.13051-0.17501-0.07178 0-0.322-0.37108-0.55606-0.82465-0.23406-0.45355-0.64408-1.1512-0.91116-1.5504-0.26708-0.39914-0.4856-0.79973-0.4856-0.89019 0-0.0905-0.11719-0.26173-0.26042-0.3806-0.58572-0.48611-0.77074-0.31704 4.7988-4.3849 1.2756-0.93166 3.8817-2.838 5.7915-4.2363 1.9097-1.3983 3.8628-2.8168 4.3403-3.1523 0.47743-0.33547 1.4337-1.0268 2.125-1.5362 0.69134-0.50946 1.2924-0.92629 1.3358-0.92629 0.09584 0 4.2779 2.5667 7.954 4.8818 0.74001 0.46602 1.9509 1.2267 2.691 1.6903 0.74001 0.46366 2.0685 1.3035 2.9521 1.8663 0.88365 0.56282 1.8993 1.1912 2.2569 1.3964l0.65029 0.37316 0.08681 9.349 0.08681 9.349 1.7375 1.6493c0.95564 0.90711 2.8306 2.6641 4.1666 3.9043 1.336 1.2403 3.0541 2.8479 3.818 3.5726 0.76388 0.72466 1.7209 1.617 2.1267 1.9829l0.73784 0.66533v5.4702l-1.8663 1.7214c-1.0265 0.94676-2.8429 2.6143-4.0364 3.7057s-3.0863 2.8234-4.206 3.8489l-2.0359 1.8646h-10.178zm44.928-0.35907c-0.81162-0.72847-2.0616-1.8549-2.7778-2.5032-0.71614-0.64827-1.6494-1.4769-2.074-1.8414-0.42454-0.36449-1.0195-0.89707-1.322-1.1835-0.6249-0.5916-1.3296-1.2259-3.2481-2.9236l-1.342-1.1875v-5.5304l1.2582-1.1688c0.69205-0.64283 2.0031-1.8719 2.9135-2.7313 3.1103-2.936 5.81-5.4234 7.0695-6.5134 0.69228-0.59914 1.2701-1.2146 1.284-1.3678 0.0139-0.15316 7e-3 -4.3483-0.0157-9.3226l-0.0409-9.0442 0.66666-0.51369c0.61158-0.47127 2.5528-1.715 6.2001-3.9726 0.77604-0.48034 1.9578-1.2298 2.6262-1.6655 0.6684-0.43567 2.5399-1.6335 4.159-2.6617 2.6298-1.6702 2.9815-1.8464 3.2986-1.6525 0.34354 0.2101 6.3319 4.5745 10.945 7.9769 1.2413 0.91552 3.4087 2.5085 4.8163 3.54 1.4077 1.0315 2.5995 1.9403 2.6486 2.0197 0.049 0.0793-0.70505 1.4987-1.6758 3.154-2.8572 4.8724-3.3393 5.6909-4.5061 7.6511-0.61016 1.025-1.2287 2.0796-1.3746 2.3437-0.71819 1.3004-1.8265 3.0907-1.9451 3.1422-0.0734 0.0319-0.13346 0.13602-0.13346 0.23153 0 0.0955-0.49762 1.007-1.1058 2.0254-2.2415 3.7536-5.7483 9.683-6.0921 10.3-0.31113 0.55892-3.6653 6.2278-4.092 6.9158-0.0888 0.14323-1.0558 1.7838-2.1489 3.6458-1.0931 1.862-2.1139 3.5612-2.2685 3.776-0.28035 0.38959-0.29418 0.39062-5.2643 0.3881l-4.9832-2e-3zm-30.488-29.19c0.33146-2.6778 0.49448-4.1171 0.62353-5.5048 0.07992-0.85937 0.23344-2.2656 0.34117-3.125 0.10772-0.85937 0.25708-2.2699 0.3319-3.1344 0.07482-0.86455 0.18698-1.6543 0.24925-1.7551 0.18909-0.30595 0.18391-3.7809-0.0062-4.1451-0.17195-0.32945-0.40384-0.87562-0.71575-1.6858-0.08271-0.21484-0.23896-0.60546-0.34722-0.86804-0.10826-0.26259-0.28542-0.69227-0.39368-0.95486-0.10826-0.26259-0.25406-0.63368-0.32399-0.82465-0.1897-0.51801-0.54103-1.3489-0.7147-1.6903-0.08434-0.16581-0.15335-0.3815-0.15335-0.47932 0-0.17101-0.5518-1.5-0.88224-2.1248-0.087676-0.1658-0.15942-0.45877-0.15942-0.65104 0-0.19227-0.07812-0.34957-0.17361-0.34957-0.09549 0-0.17361-0.11825-0.17361-0.26278 0-0.14452-0.06901-0.39843-0.15335-0.56424-0.08434-0.1658-0.24971-0.53583-0.36748-0.82229-0.11776-0.28646-0.28313-0.65649-0.36748-0.8223-0.08434-0.1658-0.15335-0.45877-0.15335-0.65103 0-0.19227-0.06901-0.34958-0.15337-0.34958-0.08435 0-0.19523-0.17578-0.2464-0.39062-0.05116-0.21484-0.14751-0.5664-0.2141-0.78125l-0.12107-0.39062h18.336c10.085 0 18.336 0.03822 18.336 0.08498 0 0.04673-0.20249 0.61314-0.44997 1.2587-0.64118 1.6724-0.69824 1.8186-0.89914 2.3022-0.0991 0.23872-0.42956 1.0981-0.73421 1.9097-0.67522 1.7989-0.76847 2.0413-1.0184 2.6476-0.36666 0.88934-0.50937 1.2564-0.8943 2.3003-0.21127 0.57291-0.53138 1.3728-0.71137 1.7776-0.18 0.40477-0.32726 0.84938-0.32726 0.98801 0 0.13864-0.0781 0.30034-0.17361 0.35936-0.0955 0.05903-0.17361 0.22072-0.17361 0.35936s-0.16472 0.60248-0.36604 1.0308c-0.21893 0.46577-0.31595 0.90108-0.24139 1.0832 0.0685 0.16745 0.19455 1.1248 0.27995 2.1274s0.23277 2.5651 0.32748 3.4722c0.0947 0.90712 0.25755 2.5087 0.36188 3.559 0.10432 1.0503 0.26035 2.6128 0.34673 3.4722 0.0863 0.85938 0.20492 2.168 0.26343 2.908l0.10639 1.3455-11.954 0.0215c-6.5748 0.0118-12.919 0.0476-14.098 0.0794l-2.1436 0.058zm-18.097-36.282-2.839-0.0478 0.09243-0.64666c0.1205-0.84294 0.63918-3.3287 0.98624-4.7265 0.10669-0.42968 0.26362-1.1328 0.34874-1.5625 0.14591-0.73657 0.2642-1.286 0.70074-3.2552 0.16802-0.7579 0.32243-1.57 0.60245-3.1684 0.05855-0.3342 0.17392-0.76389 0.25639-0.95486 0.08248-0.19097 0.1973-0.62065 0.25516-0.95486 0.12295-0.71009 0.34643-1.8179 0.61289-3.0382 0.10426-0.47743 0.26051-1.2196 0.34722-1.6493 0.08672-0.42968 0.23598-1.1328 0.3317-1.5625 0.09572-0.42969 0.25508-1.1719 0.35415-1.6493 0.09907-0.47742 0.25932-1.2196 0.35612-1.6493 0.0968-0.42969 0.22094-1.0547 0.27588-1.3889 0.05493-0.33421 0.16586-0.80296 0.2465-1.0417 0.08064-0.23871 0.19613-0.80512 0.25663-1.2587l0.11001-0.82464h27.767c15.272 0 27.77 0.0586 27.775 0.1302 4e-3 0.0716 0.0866 0.48177 0.18311 0.91145 0.0966 0.42969 0.2494 1.1133 0.33965 1.5191 0.0903 0.40582 0.23798 1.0699 0.32824 1.4757 0.0903 0.40581 0.23863 1.0503 0.32971 1.4323 0.0911 0.38194 0.25948 1.1241 0.37423 1.6493 0.11474 0.52517 0.27099 1.2283 0.34721 1.5625 0.0762 0.3342 0.23248 1.0373 0.34723 1.5625 0.11474 0.52517 0.28283 1.2673 0.37353 1.6493 0.0907 0.38195 0.2386 1.046 0.32867 1.4757 0.0901 0.42969 0.23879 1.0937 0.33048 1.4757 0.34241 1.4263 0.50035 2.1088 0.70304 3.0382 0.26869 1.2319 0.5197 2.3616 0.69437 3.125 0.0764 0.33419 0.23292 1.0373 0.34767 1.5625 0.11474 0.52518 0.27506 1.2283 0.35624 1.5625 0.0812 0.3342 0.23724 0.99825 0.34677 1.4757 0.10954 0.47743 0.27294 1.1805 0.36312 1.5625 0.0902 0.38194 0.21054 1.0751 0.26748 1.5403l0.10352 0.84591-31.231-0.06467c-17.177-0.03556-32.508-0.086156-34.07-0.11244z" fill="#fff" id="path1" /></svg>';
        }
    }
}

// Show user's account address.
export function showAccountAddress(address, pAddress) {
    if (typeof address !== "undefined") {
        if (address.startsWith("0x")) {
            updateCurrentAccountStatus(address, null, true, undefined, pAddress);
        } else {
            updateCurrentAccountStatus(pAddress, null, true, undefined, address);
        }

        document.getElementById('ConnectWalletText').innerText = address;
    } else {
        if (DappObject.selectedAddress && DappObject.selectedAddress.startsWith("0x")) {
            document.getElementById('ConnectWalletText').innerText = DappObject.selectedAddress;
        }
    }
}

//Functions to show the requested info
export function showBalance(balanceAddress, wrapBool = true, staking = false) {
    if (balanceAddress) {
        document.getElementById("Balance").innerText = balanceAddress;
    } else {
        if (wrapBool === true) {
            document.getElementById("Balance").innerText = cachedValues.balance;
        } else {
            if (staking === true) {
                document.getElementById("Balance").innerText = cachedValues.pBalance;
            } else {
                document.getElementById("Balance").innerText = cachedValues.tokenBalance;
            }
        }

        document.querySelectorAll(".odometer-radix-mark").forEach(element => {
            if (dappLanguage === "fr_FR") {
                element.innerText = ",";
            } else {
                element.innerText = ".";
            }
        });
    }
}

export function showTokenBalance(tokenBalanceAddress, wrapBool = true) {
    if (tokenBalanceAddress) {
        document.getElementById("TokenBalance").innerText = tokenBalanceAddress;
    } else {
        if (wrapBool === true) {
            document.getElementById("TokenBalance").innerText = cachedValues.tokenBalance;
        } else {
            document.getElementById("TokenBalance").innerText = cachedValues.balance;
        }

        document.querySelectorAll(".odometer-radix-mark").forEach(element => {
            if (dappLanguage === "fr_FR") {
                element.innerText = ",";
            } else {
                element.innerText = ".";
            }
        });
    }
}

// Is value a number?
export function isNumber(value) {
    if (void 0 === value || null === value) {
        return false;
    }
    if (typeof value == "number") {
        return true;
    }
    return !isNaN(value - 0);
}

export function showRewards(Rewards) {
    document.getElementById('ClaimButtonText').innerText = Rewards;
}